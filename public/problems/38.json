{
  "id": "38",
  "title": "String Length",
  "difficulty": "Easy",
  "category": "String Functions",
  "description": "Calculate the length of string values.\n\nYou have a DataFrame with a `name` column. Add a `name_length` column containing the character count of each name.",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('Alice',), ('Bob',), ('Christopher',)]\ninput_df = spark.createDataFrame(data, ['name'])",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'name_length' in result.columns, 'Missing name_length column'\nlengths = [row['name_length'] for row in result.collect()]\nassert 5 in lengths and 3 in lengths and 11 in lengths, 'Length not calculated correctly'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "F.length() returns character count",
    "Returns null for null inputs"
  ],
  "solution": "def etl(input_df):\n    return input_df.withColumn('name_length', F.length('name'))"
}
