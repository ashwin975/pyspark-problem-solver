{
  "id": "39",
  "title": "Array Contains",
  "difficulty": "Medium",
  "category": "Transformations",
  "description": "Check if an array column contains a specific value.\n\nYou have a DataFrame with an `items` array column. Add a `has_item` boolean column that is true if the array contains 'target'.",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\nfrom pyspark.sql.types import ArrayType, StringType\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('R1', ['apple', 'target', 'banana']), ('R2', ['orange', 'grape']), ('R3', ['target'])]\ninput_df = spark.createDataFrame(data, ['id', 'items'])",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'has_item' in result.columns, 'Missing has_item column'\nresults = result.collect()\nassert results[0]['has_item'] == True, 'First row should have target'\nassert results[1]['has_item'] == False, 'Second row should not have target'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "F.array_contains(array_col, value)",
    "Returns boolean"
  ],
  "solution": "def etl(input_df):\n    return input_df.withColumn('has_item', F.array_contains('items', 'target'))"
}
