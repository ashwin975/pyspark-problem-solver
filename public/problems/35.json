{
  "id": "35",
  "title": "Add Months to Date",
  "difficulty": "Easy",
  "category": "Date Functions",
  "description": "Add a specified number of months to a date column.\n\nYou have a DataFrame with a `date_col` column. Add a `new_date` column that is 3 months after the original date.",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('2023-01-15',), ('2023-06-01',), ('2023-11-30',)]\ninput_df = spark.createDataFrame(data, ['date_col'])\ninput_df = input_df.withColumn('date_col', F.to_date('date_col'))",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'new_date' in result.columns, 'Missing new_date column'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "F.add_months(date_column, num_months)",
    "Works with negative numbers too"
  ],
  "solution": "def etl(input_df):\n    return input_df.withColumn('new_date', F.add_months('date_col', 3))"
}
