{
  "id": "51",
  "title": "Cast Data Types",
  "difficulty": "Easy",
  "category": "Transformations",
  "description": "Convert column data types.\n\nYou have a DataFrame with a `str_col` column containing numeric strings. Add two new columns:\n- `int_col`: the value cast to integer\n- `double_col`: the value cast to double",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('100',), ('250',), ('999',)]\ninput_df = spark.createDataFrame(data, ['str_col'])",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'int_col' in result.columns, 'Missing int_col column'\nassert 'double_col' in result.columns, 'Missing double_col column'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "cast('integer'), cast('double'), cast('string')",
    "Also cast('date'), cast('timestamp')"
  ],
  "solution": "def etl(input_df):\n    return input_df.withColumn('int_col', F.col('str_col').cast('integer')) \\\n                   .withColumn('double_col', F.col('str_col').cast('double'))"
}
