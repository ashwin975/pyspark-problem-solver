{
  "id": "23",
  "title": "String Case Conversion",
  "difficulty": "Easy",
  "category": "String Functions",
  "description": "Convert name column to uppercase and title case.\n\nYou have a DataFrame with a `name` column. Add two new columns:\n- `upper_name`: the name in UPPERCASE\n- `title_name`: the name in Title Case",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('john doe',), ('jane smith',), ('bob wilson',)]\ninput_df = spark.createDataFrame(data, ['name'])",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'upper_name' in result.columns, 'Missing upper_name column'\nassert 'title_name' in result.columns, 'Missing title_name column'\nnames = result.collect()\nassert names[0]['upper_name'] == 'JOHN DOE', 'Uppercase not correct'\nassert names[0]['title_name'] == 'John Doe', 'Title case not correct'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "F.upper() for uppercase",
    "F.initcap() for title case"
  ],
  "solution": "def etl(input_df):\n    return input_df.withColumn('upper_name', F.upper('name')) \\\n                   .withColumn('title_name', F.initcap('name'))"
}
