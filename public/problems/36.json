{
  "id": "36",
  "title": "Extract Date Parts",
  "difficulty": "Easy",
  "category": "Date Functions",
  "description": "Extract year, month, and day from a date column.\n\nYou have a DataFrame with a `date_col` column. Add three new columns: `year`, `month`, and `day`.",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('2023-05-15',), ('2024-12-25',)]\ninput_df = spark.createDataFrame(data, ['date_col'])\ninput_df = input_df.withColumn('date_col', F.to_date('date_col'))",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'year' in result.columns, 'Missing year column'\nassert 'month' in result.columns, 'Missing month column'\nassert 'day' in result.columns, 'Missing day column'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "F.year() extracts year",
    "F.month() for month",
    "F.dayofmonth() for day"
  ],
  "solution": "def etl(input_df):\n    return input_df.withColumn('year', F.year('date_col')) \\\n                   .withColumn('month', F.month('date_col')) \\\n                   .withColumn('day', F.dayofmonth('date_col'))"
}
