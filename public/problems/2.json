{
  "id": "2",
  "title": "Geology Samples - Extract Age",
  "difficulty": "Medium",
  "category": "Regex",
  "description": "**Geology Samples**\n\nA geologist is working with a dataset containing rock samples. The DataFrame has the following schema:\n\n| Column Name | Data Type |\n|-------------|-----------|\n| sample_id   | string    |\n| description | string    |\n\nThe description field contains a mixture of letters and numbers. Extract the numeric parts from the description column and create a new column called `age`.\n\n**Example**\n\n| sample_id | description     |\n|-----------|-----------------|\n| S1        | Basalt_450Ma    |\n| S2        | Sandstone_300Ma |\n| S3        | Limestone       |\n\n**Output**\n\n| sample_id | description     | age  |\n|-----------|-----------------|------|\n| S1        | Basalt_450Ma    | 450  |\n| S2        | Sandstone_300Ma | 300  |\n| S3        | Limestone       |      |",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [\n    ('S1', 'Basalt_450Ma'),\n    ('S2', 'Sandstone_300Ma'),\n    ('S3', 'Limestone'),\n    ('S4', 'Granite_1200Ma')\n]\ncolumns = ['sample_id', 'description']\ninput_df = spark.createDataFrame(data, columns)",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'age' in result.columns, 'Missing age column'\nages = [row['age'] for row in result.collect()]\nassert '450' in ages, 'Expected 450 in ages'\nassert '300' in ages, 'Expected 300 in ages'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "Use F.regexp_extract() for pattern extraction",
    "The regex pattern \\\\d+ matches one or more digits",
    "Empty string is returned when no match found"
  ],
  "solution": "def etl(input_df):\n    output_df = input_df.withColumn(\n        'age',\n        F.regexp_extract(F.col('description'), r'(\\d+)', 0)\n    )\n    return output_df"
}
