{
  "id": "18",
  "title": "Date Formatting",
  "difficulty": "Easy",
  "category": "Date Functions",
  "description": "Convert date strings from 'yyyy-MM-dd' format to 'MM/dd/yyyy' format.\n\nYou have a DataFrame with a `date_col` column containing dates in 'yyyy-MM-dd' format. Create a new column `formatted_date` with the dates in 'MM/dd/yyyy' format.",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('2023-01-15',), ('2023-12-25',), ('2024-07-04',)]\ninput_df = spark.createDataFrame(data, ['date_col'])",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'formatted_date' in result.columns, 'Missing formatted_date column'\ndates = [row['formatted_date'] for row in result.collect()]\nassert '01/15/2023' in dates, 'Date not formatted correctly'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "Use F.to_date() to parse",
    "Use F.date_format() to format"
  ],
  "solution": "def etl(input_df):\n    return input_df.withColumn(\n        'formatted_date',\n        F.date_format(F.to_date('date_col', 'yyyy-MM-dd'), 'MM/dd/yyyy')\n    )"
}
