{
  "id": "3",
  "title": "Add Full Name Column",
  "difficulty": "Easy",
  "category": "Transformations",
  "description": "# Add Full Name Column\n\nGiven a DataFrame with `first_name` and `last_name` columns, add a new column `full_name` that concatenates them with a space.\n\n## Input Schema\n\n| Column | Type |\n|--------|------|\n| first_name | string |\n| last_name | string |\n\n## Expected Output\n\nThe original DataFrame with an additional `full_name` column.",
  "starter_code": "def solve(df):\n    # Add a full_name column\n    # return df.withColumn(...)\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('John', 'Doe'), ('Jane', 'Smith')]\ncolumns = ['first_name', 'last_name']\ndf = spark.createDataFrame(data, columns)",
  "test_validation": "result = solve(df)\nassert result is not None, 'Function returned None'\nassert 'full_name' in result.columns, 'Missing full_name column'\nnames = [row['full_name'] for row in result.collect()]\nassert 'John Doe' in names, 'Expected John Doe in results'\nassert 'Jane Smith' in names, 'Expected Jane Smith in results'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "Use withColumn() to add a new column",
    "Use F.concat() to join strings",
    "Don't forget to add a space between names using F.lit(' ')"
  ],
  "solution": "def solve(df):\n    return df.withColumn('full_name', F.concat(F.col('first_name'), F.lit(' '), F.col('last_name')))"
}
