{
  "id": "24",
  "title": "Trim Whitespace",
  "difficulty": "Easy",
  "category": "String Functions",
  "description": "Trim leading and trailing whitespace from string columns.\n\nYou have a DataFrame with a `text` column that may have leading/trailing spaces. Add a `cleaned_text` column with the whitespace removed.",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('  hello  ',), ('  world',), ('test  ',)]\ninput_df = spark.createDataFrame(data, ['text'])",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'cleaned_text' in result.columns, 'Missing cleaned_text column'\ntexts = [row['cleaned_text'] for row in result.collect()]\nassert 'hello' in texts, 'Text not trimmed correctly'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "F.trim() removes both leading and trailing spaces",
    "F.ltrim() and F.rtrim() for one-sided"
  ],
  "solution": "def etl(input_df):\n    return input_df.withColumn('cleaned_text', F.trim('text'))"
}
