{
  "id": "49",
  "title": "Column Renaming",
  "difficulty": "Easy",
  "category": "Transformations",
  "description": "Rename multiple columns at once.\n\nYou have a DataFrame with columns `old_name1` and `old_name2`. Rename them to `new_name1` and `new_name2` respectively.",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('A', 1), ('B', 2), ('C', 3)]\ninput_df = spark.createDataFrame(data, ['old_name1', 'old_name2'])",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'new_name1' in result.columns, 'Missing new_name1 column'\nassert 'new_name2' in result.columns, 'Missing new_name2 column'\nassert 'old_name1' not in result.columns, 'old_name1 should be renamed'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "withColumnRenamed(old, new)",
    "Can also use toDF() with all column names"
  ],
  "solution": "def etl(input_df):\n    return input_df.withColumnRenamed('old_name1', 'new_name1') \\\n                   .withColumnRenamed('old_name2', 'new_name2')"
}
