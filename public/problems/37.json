{
  "id": "37",
  "title": "Substring Extraction",
  "difficulty": "Easy",
  "category": "String Functions",
  "description": "Extract a substring from a string column.\n\nYou have a DataFrame with a `product_id` column (e.g., 'ABC123'). Add a `code` column containing the first 3 characters.",
  "starter_code": "def etl(input_df):\n    # Write code here\n    pass",
  "test_setup": "from pyspark.sql import SparkSession\nfrom pyspark.sql import functions as F\nfrom pyspark.sql import Window as W\n\nspark = SparkSession.builder.appName('test').getOrCreate()\n\ndata = [('ABC123',), ('XYZ789',), ('DEF456',)]\ninput_df = spark.createDataFrame(data, ['product_id'])",
  "test_validation": "result = etl(input_df)\nassert result is not None, 'Function returned None'\nassert 'code' in result.columns, 'Missing code column'\ncodes = [row['code'] for row in result.collect()]\nassert 'ABC' in codes and 'XYZ' in codes, 'Substring not extracted correctly'\nprint('âœ… TEST PASSED!')",
  "hints": [
    "Position is 1-indexed",
    "Specify start position and length"
  ],
  "solution": "def etl(input_df):\n    return input_df.withColumn('code', F.substring('product_id', 1, 3))"
}
